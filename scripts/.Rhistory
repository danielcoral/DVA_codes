v@fix
v@gt %>% t
v@gt %>% t %>% head
v@gt %>% t %>% head %>% data.frame %>% slice(-1)
v@gt %>% t %>% head %>% data.frame %>% slice(-1) %>% anyNA
v@fix
v@meta
v@fix
v@gt %>% as.matrix -> test
test[1:5,1:5]
dim(test)
rownames(test)
colnames(test)
colnames(test) %>% head
test[,1]
test <- extract.gt(v)
test %>% head
test[1:2,1:5]
test[,1:5]
test <- extract.gt(v) %>% t
head(test)
v@gt[,1:5]
test <- extract.gt(v, element = 'G', as.numeric = TRUE)
head(test)
test <- extract.gt(v, element = 'G', as.numeric = TRUE) %>% t
head(test)
test <- extract.gt(v, element = 'G', as.numeric = TRUE) %>% t %>% data.frame
head(test)
test <- extract.gt(v, element = 'G', as.numeric = TRUE) %>% t %>% data.frame %>% rownames_to_column("eid")
head(test)
rm(.x)
head(scores[[1]])
head(scores)
head(snpclus)
head(snpclus_scores)
q()
n
q()
n
cox_res
cox_tidy
cox_res$all_cause$conc
cox_res$all_cause$disc
map(cox_res, function(x) map(x, function(y) y %>% summary %>% "$"(coefficients)))
map(cox_res, function(x) map(x, function(y) y %>% summary %>% "$"(coefficients) %>% data.frame %>% slice(1)))
map(cox_res, function(x) map(x, function(y) y %>% summary %>% "$"(coefficients) %>% data.frame %>% slice(1) %>% rownames_to_column("predictor")) %>% bind_rows())
map(cox_res, function(x) map(x, function(y) y %>% summary %>% "$"(coefficients) %>% data.frame %>% slice(1) %>% rownames_to_column("predictor")) %>% bind_rows()) %>% 
cox_tidy
cox_tidy %>% ead(2)
cox_tidy %>% head(2)
cox_tidy %>% head
q()
n
q()
n
chrom_lengths
chrom_lengths
g$data
g$data %>% filter(sig)
g$data %>% filter(!is.na(sig))
g$data %>% filter(!is.na(sig), chr == 22)
q()
n
)
q()
n
pheno_scan %>% head
pheno_scan %>% group_by(id) %>% summarise(n = n())
pheno_scan %>% group_by(id) %>% summarise(n = n()) %>% filter(n != 0)
pheno_scan %>% group_by(id) %>% summarise(n = n()) %>% filter(n != 67)
pheno_scan %>% group_by(id) %>% summarise(any(p < 5e-8))
pheno_scan %>% group_by(id) %>% summarise(test = any(p < 5e-8)) %>% filter(test)
pheno_scan %>% group_by(id) %>% summarise(trait = unique(trait), test = any(p < 5e-8)) %>% filter(test)
pheno_scan %>% group_by(id) %>% summarise(trait = unique(trait), test = any(p < 5e-8)) %>% filter(test) %>% data.frame
premat_phen <- pheno_scan %>% group_by(id) %>% filter(any(p < 5e-8))
head(premat_phen)
rpremat_phen
premat_phen
mat_phen
premat_phen
premat_phen <- premat_phen %>% ungroup
mat_phen
premat_phen <- premat_phen %>% ungroup
dim(mat_phen)=
dim(mat_phen)
save(list(mat_phen = mat_phen, cov_phen = cov_phen), file = "~/dva/files/forcovsurf.RData")
save(), file = "~/dva/files/forcovsurf.RData")
forcovsurf <- list(mat_phen = mat_phen, cov_phen = cov_phen)
save(forcovsurf, file = "~/dva/files/forcovsurf.RData")
q()
n
forcovsurf <- rio::import("~/dva/files/forcovsurf.RData")
names(forcovsurf)
mat_phen <- forcovsurf$mat_phen
cov_phen <- forcovsurf$cov_phen
res_phen <- CoVVSURF::covsurf(mat_phen[,-c(1:3)], factor(mat_phen$disc), kval = c(2,4,6,8,seq(10, nrow(mat_phen), by = 10)), tree = cov_phen, ncores = parallel::detectCores())
c(2,4,6,8,seq(10, nrow(mat_phen), by = 10)
)
c(2,4,6,8,seq(10, ncol(mat_phen), by = 10)
)
res_phen <- CoVVSURF::covsurf(mat_phen[,-c(1:3)], factor(mat_phen$disc), kval = c(2,4,6,8,seq(10, ncol(mat_phen), by = 10)), tree = cov_phen, ncores = parallel::detectCores())
res_phen <- CoVVSURF::covsurf(mat_phen[,-c(1:3)], factor(mat_phen$disc), kval = c(2,4,6,8,seq(10, ncol(mat_phen) - 1, by = 10)), tree = cov_phen, ncores = parallel::detectCores())
res_phen <- CoVVSURF::covsurf(mat_phen[,-c(1:3)], factor(mat_phen$disc), kval = c(2,4,6,8,seq(10, ncol(mat_phen) - 3, by = 10)), tree = cov_phen, ncores = parallel::detectCores())
mat_phen
mat_phen %>% names
names(mat_phen)
res_phen <- CoVVSURF::covsurf(mat_phen[,-c(1:2)], factor(mat_phen$disc), kval = c(2,4,6,8,seq(10, ncol(mat_phen) - 2, by = 10)), tree = cov_phen, ncores = parallel::detectCores())
pheno_scan <- rio::import("~/dva/files/pheno_scan.tsv")
premat_phen <- pheno_scan %>% group_by(grpid) %>% filter(any(p<5e-8)) %>% ungroup
library(tidyverse)
premat_phen <- pheno_scan %>% group_by(grpid) %>% filter(any(p<5e-8)) %>% ungroup
premat_phen$grpid %>% unique %>% length
res_phen$kopt
res_phen$vsel
resvars_phen
resvars_phen %>% select(cluster, grpid, squared.loading, trait)
resvars_phen %>% select(cluster, grpid, squared.loading, trait) %>% unique
resvars_phen %>% select(cluster, grpid, squared.loading, trait) %>% unique %>% data.frame
resvars_phen %>% filter(inmod) %>% select(cluster, grpid, squared.loading, trait) %>% data.frame
resvars_phen %>% filter(inmod) %>% select(cluster, grpid, squared.loading, trait) %>% unique %>% data.frame
q()
n
premat_phen <- rio::import("~/dva/files/premat_phen.tsv")
premat_phen %>% head
library(tidyverse)
premat_phen %>% head
premat_phen %>% pull(grpid) %>% unique
premat_phen %>% group_by(grpid) %>% summarise(sum(p<5e-8))
premat_phen %>% group_by(grpid) %>% summarise(n=sum(p<5e-8)) %>% arrange(desc(n))
premat_phen %>% group_by(grpid, trait) %>% summarise(n=sum(p<5e-8)) %>% arrange(desc(n))
premat_phen %>% group_by(grpid, trait) %>% summarise(n=sum(p<5e-8)) %>% data.frame
premat_phen %>% group_by(grpid, trait) %>% summarise(n=sum(p<5e-8))
premat_phen %>% head
pheno_scan <- rio::import("~/dva/files/pheno_scan.tsv")
head(pheno_scan)
rm(pheno_scan)
premat_phen$trait
unique(premat_phen$trait)
premat_phen %>% head(2)
mrdat_bmisig
mrdat_bmisig %>% head
all(mrdat_bmisig$beta.bmi > 0)
mrdat_bmisig %>%
    mutate(disc = ifelse(beta.exposure < 0, "Discordant", "Concordant")) %>% head
table(mr_profile$disc)
mr_profiles <- mr_profile
q()
n
mr_profiles %>% head
head(mr_uni)
head(mr_p)
head(mr_p)
q()
n
q()
n
